---
title: "R for Graph, Network and Trees"
subtitle: "Applications in Biomedical Research"
author: "Xiaotao Shen 2025/4/7"
institute: "Lee Kong Chian School of Medicine, NTU"
date: "2025/4/7"
format: 
  pptx:
    reference-doc: ppt_template.pptx
    slide-level: 2
    fig-width: 7
    fig-height: 5
    fig-dpi: 300
editor: visual
---

## About the class

-   **Instructor**: Xiaotao Shen (https://www.shen-lab.org/)

-   **Email**: xiaotao.shen\@ntu.edu.stg

-   **WhatsApp**: +1 5712679283

-   **Github Repo**: https://github.com/jaspershen-lab/MD7115-NTU

-   **Reference**:

1.  [R for Data Science](https://r4ds.had.co.nz/)
2.  [R Graphics Cookbook](https://r-graphics.org/)
3.  [Network Analysis with R](https://www.amazon.com/Network-Analysis-R-Use/dp/3319238822)

## Introduction

In this course, we will learn how to use R to analyze and visualize data in the form of graphs, networks and trees. We will cover the following topics.

1.  What is a graph, network and tree?

2.  Their applications in biomedical research

3.  How to use R to analyze and visualize them

## Preparation

We need to install some R packages before the class.

Some packages are in Bionconductor, so we need to install `BiocManager` first.

```{r, echo=TRUE, eval = TRUE}
if (!requireNamespace("BiocManager", quietly = TRUE)){
install.packages("BiocManager")
}
```

## Preparation

`tidyverse` is a collection of R packages designed for data science, and it includes `ggplot2`, which is a basic graph package for network and tree in R.

```{r, echo=TRUE, eval = TRUE}
if (!requireNamespace("tidyverse", quietly = TRUE)){
install.packages("tidyverse")
}
```

## Preparation

Some specific packages for graph, network and tree analysis.


```{r, echo=TRUE, eval = TRUE}
if (!requireNamespace("igraph", quietly = TRUE)){
install.packages("igraph")
}
if(!requireNamespace("ggraph", quietly = TRUE)){
install.packages("ggraph")
}
```


## Preparation

Some specific packages for graph, network and tree analysis.


```{r, echo=TRUE, eval = TRUE}
if(!requireNamespace("tidygraph", quietly = TRUE)){
install.packages("tidygraph")
}
if(!requireNamespace("ggnetwork", quietly = TRUE)){
install.packages("ggnetwork")
}
```

## Preparation

Some specific packages for graph, network and tree analysis.


```{r, echo=TRUE, eval = TRUE}
if(!requireNamespace("ggtree", quietly = TRUE)){
BiocManager::install("ggtree")  
}
if(!requireNamespace("treeio", quietly = TRUE)){
BiocManager::install("treeio")  
}
if(!requireNamespace("ggtreeExtra", quietly = TRUE)){
BiocManager::install("ggtreeExtra")  
}
```

## What is a graph?

A graph is a collection of nodes (vertices) and edges (links) that connect pairs of nodes.

A small undirected graph with numbered nodes.

![](images/graph.png)

## Example 1

![Shen, et al. Nature Biomedical Engineering, 2024](images/ED_FIG7.jpg)

## Example 1

### What's the network?

**Nodes**: 

- Wearable data: Step, HR, and CGM (continuous glucose monitoring) data

- Omics data: Proteins, metabolites, and lipids


**Edges**: 

- Lagged correlations

- Blue: negative correlations

- Red: positive correlations

![Shen, et al. Nature Biomedical Engineering, 2024](images/ED_FIG7.jpg)


## Read the data

```{r, echo=TRUE, eval = TRUE}
## node data
if (!require(readr)) {
  install.packages("readr")
}
node_data <-
  readr::read_csv(
    "https://raw.githubusercontent.com/jaspershen-lab/MD7115-NTU/main/2_demo_data/example_node_data.csv"
  )
```


## Read the data

```{r, echo=TRUE, eval = TRUE}
##edge data
edge_data <-
  readr::read_csv(
    "https://raw.githubusercontent.com/jaspershen-lab/MD7115-NTU/main/2_demo_data/example_edge_data.csv"
  )
```

## Node data

```{r, echo=TRUE, eval = TRUE}
head(node_data)
```



## More references

1. [Morden Statistics for Morden Biology](https://web.stanford.edu/class/bios221/book/10-chap.html#combining-phylogenetic-trees-into-a-data-analysis)

2. [Network Analysis with R](https://www.amazon.com/Network-Analysis-R-Use/dp/3319238822)

